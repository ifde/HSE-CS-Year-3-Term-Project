= ТЕКСТ ПРОГРАММЫ

== Исходный код программы

#h(2em) Исходный код программы доступен в удаленном репозитории GitHub: https://github.com/ifde/dex

= ОПИСАНИЕ ПРОГРАММЫ

== Описание проекта

#h(2em)Данный проект реализует библиотеку смарт-контрактов (хуков) для протокола Uniswap V4, предназначенную для динамического изменения комиссий в пулах ликвидности децентрализованных бирж (DEX). Он позволяет автоматически корректировать размер комиссии на основе рыночных условий (волатильности, объема торгов, арбитражного спреда), что снижает непостоянные потери для поставщиков ликвидности и повышает эффективность DEX.

=== Основной функционал проекта включает:

==== Реализация библиотеки смарт-контрактов (хуков) динамических комиссий для Uniswap V4
#h(2em) Базовое наследование от контракта BaseOverrideFee с унифицированным интерфейсом.
==== Разработка нескольких типов хуков с различными алгоритмами расчета комиссий
#h(2em) На основе истории свопов, объема торгов, данных с централизованных бирж (CEX).
==== Интеграция с оракулом Chainlink для получения актуальных ценовых данных
#h(2em) Обеспечение совместимости с внешними источниками информации.
==== Совместимость с ключевыми артефактами Uniswap V4
#h(2em) PoolManager, SwapRouter, PositionManager для создания пулов, управления ликвидностью и выполнения свопов.
==== Инфраструктура для тестирования и развертывания
#h(2em) Скрипты для автоматического развертывания на локальном блокчейне (Anvil), тесты симуляции торговой активности.
==== Веб-интерфейс для конструирования смарт-контрактов
#h(2em) Выбор типа комиссии, настройка параметров, генерация кода и сборка готового проекта.
==== Анализ эффективности алгоритмов на исторических данных
#h(2em) Использование данных Binance API для тестирования и сравнения. \

== Структура проекта

=== Основные директории и файлы:

==== src/
#h(2em) Директория с основными смарт-контрактами хуков динамических комиссий (например, MEVChargeHook.sol, PegStabilityHook.sol и др.).
==== script/
#h(2em) Скрипты для развертывания хуков и создания пулов ликвидности (deployHook.s.sol, deployHookAndCreatePool.s.sol).
==== script/base/
#h(2em) Вспомогательные контракты и утилиты для развертывания (HookHelpers.sol, LiquidityHelpers.sol, BaseScript.sol).
==== test/
#h(2em) Тесты для смарт-контрактов, включая симуляцию торговой активности и изменение комиссий (MEVChargeHookFees.t.sol, testHook.t.sol).
==== test/utils/
#h(2em) Утилиты для тестирования (HookTest.sol, HookConstants.sol, HookFlags.sol).
==== web_interface/
#h(2em) Веб-интерфейс на Python/Flask для конфигурации и генерации хуков (app.py, templates/, static/).
==== simulation/
#h(2em) Скрипты для симуляции торговли и анализа эффективности на исторических данных (simulation.py, TRADE_SIMULATION.md).
==== lib/
#h(2em) Внешние зависимости: Uniswap V4 Core/Periphery, Chainlink, OpenZeppelin.
==== foundry.toml
#h(2em) Конфигурация Foundry (Forge).

== Описание работы компонентов

=== Смарт-контракты (хуки) на Solidity
#h(2em) Основные контракты реализуют логику динамических комиссий.

==== MEVChargeHook.sol
#h(2em) Хук для комиссий на основе MEV (Maximal Extractable Value) и арбитражного спреда.
==== PegStabilityHook.sol
#h(2em)  Хук для стабилизации цены через корректировку комиссий на основе отклонения от целевой цены.
==== Другие хуки (BAHook.sol, DAHook.sol, ABHook.sol)
#h(2em)  Различные алгоритмы расчета комиссий.
==== Базовые контракты (BaseOverrideFee.sol)
#h(2em) Унифицированный интерфейс для всех хуков.

=== Функции контрактов:

==== getFee(...)
#h(2em) Расчет комиссии на основе параметров свопа и рыночных данных.
==== beforeSwap(...)
#h(2em) Хук, вызываемый перед свопом для корректировки комиссии.
==== Интеграция с Chainlink Price Feeds
#h(2em) Используется для получения внешних данных (цен токенов на централизованных биржах).

=== Скрипты развертывания (Solidity/Forge)
#h(2em) Foundry используется для компиляции, тестирования и развертывания на локальном (Anvil) или реальном блокчейне.

==== deployHook.s.sol
#h(2em) Развертывание выбранного хука с указанием адресов оракулов.
==== HookHelpers.sol
#h(2em) Утилиты для развертывания, включая создание mock-оракулов и токенов.

=== Тесты (Solidity/Forge)
#h(2em) Тесты симулируют работу хуков. Тесты включают fuzz-тестирование, симуляцию свопов и проверку корректности комиссий.

==== MEVChargeHookFees.t.sol
#h(2em) Тестирование комиссий и взаимодействия с Uniswap V4.
==== testHook.t.sol
#h(2em) Общие тесты для всех хуков.
====== HookTest.sol
#h(2em) Базовый контракт для тестирования с развертыванием инфраструктуры.

=== Веб-интерфейс (Python/Flask)
#h(2em) Интерфейс позволяет конструировать хуки.
#h(2em) Функционал: выбор типа хука и параметров, генерация Solidity-кода, сборка и скачивание ZIP-проекта с зависимостями

==== app.py
#h(2em) Основной сервер на Flask, обрабатывающий запросы.
==== web_interface/templates/
#h(2em) HTML-шаблоны для интерфейса.

=== Симуляция и анализ (Python)

==== simulation.py
#h(2em) Скрипт для симуляции торговли с использованием рыночных данных.
==== fetch_binance_data.py
#h(2em) Скрипт для получения актуальных рыночных данных с Binace через API

== Технологии

=== Языки программирования

==== Solidity
#h(2em) Основной язык для смарт-контрактов и хуков.
==== Python
#h(2em) Для веб-интерфейса, симуляции и анализа данных.
==== HTML/CSS/JavaScript
#h(2em) Для фронтенда веб-интерфейса.

=== Инструменты разработки

==== Foundry (Forge, Anvil, Cast)
#h(2em) Фреймворк для разработки, тестирования и развертывания смарт-контрактов.
==== Uniswap V4 Core & Periphery
#h(2em) Базовые контракты для DEX и хуков.
==== Chainlink
#h(2em) Оракулы для ценовых данных.
==== Binance API
#h(2em) API для получения исторических данных о ценах.
==== OpenZeppelin Contracts & UniswapHooks
#h(2em) Библиотеки шаблонов.
==== Flask
#h(2em) Фреймворк для веб-интерфейса.
